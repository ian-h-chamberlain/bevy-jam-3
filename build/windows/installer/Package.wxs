<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs" xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
    <!--
        in theory , Version could be pulled from the executable if we added it in
        with embed-resource but leaving it blank to be overridden on command line
        seems to work fine.
    -->
    <Package
        Name="Pist Off"
        Manufacturer="Ian Chamberlain"
        UpgradeCode="1b8656b4-db80-486a-9e2d-4eb599b35485"
        Version=""

        Scope="perUserOrMachine">
        <MajorUpgrade DowngradeErrorMessage="!(loc.DowngradeError)" />

        <Media Id="1" Cabinet="myapplication.cab" EmbedCab="yes" />

        <Property Id="ApplicationFolderName" Value="!(bind.Property.ProductName)" />

        <!-- Installer Icon -->
        <Icon Id="icon.ico" SourceFile="..\icon.ico"/>
        <Property Id="ARPPRODUCTICON" Value="icon.ico" />

        <!-- Sets the default installation folder -->
        <StandardDirectory Id="ProgramFiles6432Folder">
            <Directory Id="INSTALLFOLDER" Name="!(bind.Property.ProductName)" />
        </StandardDirectory>

         <!-- Shows a UI that allows customizing the install location -->
        <ui:WixUI Id="WixUI_CustomInstallDir" InstallDirectory="INSTALLFOLDER" />

        <Feature Id="Main">
            <ComponentGroupRef Id="MainComponent" />
            <ComponentRef Id="StartMenuShortcut" />
            <ComponentGroupRef Id="AssetsDirectory" />
            <ComponentGroupRef Id="CreditsDirectory" />
        </Feature>

        <!-- Installs the actual files -->
        <ComponentGroup Id="MainComponent" Directory="INSTALLFOLDER">
            <Component>
                <File Id="Executable" Source="..\..\..\target\release\pist-off.exe" Vital="true" />
            </Component>
        </ComponentGroup>

        <!-- Start menu shortcut -->
        <!-- Source: https://wixtoolset.org/docs/v3/howtos/files_and_registry/create_start_menu_shortcut/ -->
        <StandardDirectory Id="ProgramMenuFolder">
            <Component Id="StartMenuShortcut" Guid="*">
                <Shortcut Id="ApplicationStartMenuShortcut" Name="!(bind.Property.ProductName)" Target="[!Executable]" WorkingDirectory="INSTALLFOLDER" />
                <RegistryValue Root="HKCU" Key="Software\!(bind.Property.ProductName)" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
          </Component>
      </StandardDirectory>
  </Package>
</Wix>
